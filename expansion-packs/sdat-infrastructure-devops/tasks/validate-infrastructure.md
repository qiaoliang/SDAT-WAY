# Infrastructure Validation Task

## 任务目的

在部署前，全面验证平台基础设施变更是否符合安全、可靠性、运维和合规等要求。此任务确保所有平台基础设施均满足组织标准，遵循最佳实践，并能与 SDAT 生态系统良好集成。

## 相关文档

- **基础设施变更文档**：`docs/infrastructure/{ticketNumber}.change.md`
- **基础设施架构文档**：`docs/infrastructure-architecture.md`（由架构师 Agent 提供）
- **基础设施指南**：`docs/infrastructure/guidelines.md`
- **技术栈文档**：`docs/tech-stack.md`
- **基础设施验证清单**：`infrastructure-checklist.md`（主要验证框架，涵盖16个综合章节）

## 关键活动与操作指引

### 1. 确认交互模式

- 询问用户：“您希望如何进行平台基础设施验证？我们可以选择以下两种方式：
  A. **默认推荐增量模式**：我们将逐步、系统地按照验证清单的每个章节进行验证，对每一项都记录合规或差距，然后再进入下一章节。此方式适合需要全面、细致记录整个平台栈的场景。
  B. **‘YOLO’ 快速模式**：我可以对所有清单项进行快速整体评估，并直接给出一份综合验证报告。这种方式更快，但可能遗漏增量模式下能发现的细节问题。”例如：“请告知您选择A还是B。”
- 用户选择后，确认所选模式，并据此继续后续流程。

### 2. 初始化平台验证

- 审查基础设施变更文档，明确平台实施范围与目标
- 分析基础设施架构文档，理解平台设计模式及合规要求
- 查阅基础设施指南，确保各平台组件符合组织标准
- 准备验证环境与工具，确保平台测试的全面性
- <critical_rule>必须确认基础设施变更请求已获批准后方可进行验证。否则，立即暂停并告知用户。</critical_rule>

### 3. 架构设计审查门禁

- **DevOps/平台 → 架构师设计审查：**
    - 系统性审查基础设施架构文档，评估其可实施性
    - 针对以下方面评估架构决策与运维约束和能力的契合度：
        - **实施复杂度**：评估所提架构能否用现有工具和团队能力实现
        - **运维可行性**：验证运维模式是否适合当前组织成熟度
        - **资源可用性**：确认所需基础设施资源可用且在预算范围内
        - **技术兼容性**：验证所选技术能否与现有基础设施良好集成
        - **安全实现**：确保安全模式可用现有安全工具链落地
        - **维护负担**：评估后续运维和维护的工作量
    - 记录设计审查发现与建议：
        - **可实施部分**：记录可按设计实现的架构决策
        - **实施关注点**：指出可能面临实施挑战的架构决策
        - **所需修改**：建议为实现架构所需的具体变更
        - **替代方案**：如有必要，提出可选的实现模式
    - **协作决策点**：
        - 如发现**关键实施阻碍**：立即暂停验证并升级至架构师 Agent 进行架构修订
        - 如仅有**次要关注点**：记录关注点，继续验证，并注明需调整的实施细节
        - 如**架构已通过**：进入全面平台验证阶段
    - <critical_rule>所有关键设计审查问题必须在进入详细验证前解决</critical_rule>

### 4. 执行全面平台验证流程

- **如选择“增量模式”**：针对1-16章依次进行：
    - **a. 章节目的说明**：解释本章节验证内容及其对平台运维的重要性
    - **b. 条目逐项验证**：逐条展示清单项，引导用户验证并记录合规或差距
    - **c. 合规证据收集**：对每个合规项，记录验证合规的具体方式
    - **d. 差距记录**：对每个不合规项，记录具体问题及建议的补救措施
    - **e. 平台集成测试**：针对13-16章，验证平台组件间的集成情况
    - **f. 提供高级自我反思与需求获取选项（#offer-advanced-self-refinement--elicitation-options）**
    - **g. 章节小结**：给出本章节合规百分比，突出关键发现，再进入下一章节

- **如选择“YOLO模式”**：基础设施1-12章+平台工程13-16章
    - 记录所有平台组件各项的合规状态
    - 识别并记录影响平台运行的关键不合规问题
    - 呈现全章节的综合验证报告
    - <important_note>在YOLO模式下呈现完整验证报告后，仍可主动提供“高级自我反思与需求获取选项”菜单，便于对有问题的具体章节做更深入探讨。</important_note>

### 5. 生成全面平台验证报告

- 按16个清单章节汇总各部分验证发现
- 计算并展示整个平台栈的总体合规百分比
- 明确记录所有不合规项及其按平台影响优先级排序的补救计划
- 突出影响平台可靠性的关键安全或运维风险
- 包含设计审查发现及架构实施建议
- 基于完整平台评估，给出验证签字建议
- 记录平台组件集成验证结果

### 6. SDAT 集成评估

- 审查平台基础设施变更对其他 SDAT Agent 的支持情况：
    - **开发 Agent 对齐：** 验证平台基础设施是否支持前端开发、后端开发和全栈开发的需求，包括：
        - 容器平台开发环境的自动化配置
        - 应用部署的 GitOps 工作流
        - 服务网格集成以支持开发测试
        - 开发者体验平台的自助服务能力
    - **产品对齐：** 确保平台基础设施实现了产品负责人 PRD 中的要求，包括：
        - 通过容器平台满足可扩展性和性能需求
        - 通过 GitOps 工作流实现部署自动化
        - 通过服务网格提升服务可靠性
    - **架构对齐：** 验证平台实现是否与架构决策保持一致，包括：
        - 各平台组件的技术选型均已正确落地
        - 容器平台、服务网格和 GitOps 的安全架构已实现
        - 平台组件间的集成模式已正确实现
    - 记录所有集成点及其对其他 Agent 工作流的潜在影响

### 7. 后续步骤建议

- 如验证通过：
    - 准备平台部署建议及各组件依赖关系说明
    - 列出完整平台栈的监控需求
    - 建议平台运维的知识转移活动
    - 记录平台就绪认证
- 如验证未通过：
    - 按平台组件及集成影响优先级排序补救措施
    - 推荐平台部署的阻断项与非阻断项
    - 安排针对失败组件的后续验证
    - 记录平台风险及缓解策略
- 如设计审查发现架构问题：
    - **升级至架构师 Agent**，进行架构修订与重新设计
    - 记录实现所需的具体架构变更
    - 安排架构修改后的后续设计审查
- 更新文档，反映所有平台组件的验证结果
- <important_note>务必确保基础设施变更请求（Infrastructure Change Request）状态已根据平台验证结果及时更新。</important_note>

## Output

A comprehensive platform validation report documenting:

1. **架构设计审查结果** —— 可实施性评估与架构建议
2. **按清单章节的合规百分比** —— 覆盖全部16章（含平台工程）
3. **各基础与平台组件不合规项的详细发现**
4. **平台集成验证结果** —— 记录组件间互操作性
5. **基于平台影响的补救建议及优先级**
6. **SDAT 集成评估结果** —— 覆盖完整平台栈
7. **明确的签字建议** —— 平台部署就绪或需架构修订
8. **按平台依赖优先级排序的实施或补救后续步骤**

## 提供高级自我反思与需求获取选项

向用户展示以下“高级反思、需求获取与头脑风暴行动”列表。说明这些是可选步骤，用于在最终确定当前部分并继续前，帮助确保质量、探索替代方案并加深对当前部分的理解。用户可通过数字选择行动，或选择跳过并完成本部分。

“为确保当前部分的质量：**[具体部分名称]**，并确保其稳健性、探索替代方案并考虑所有角度，我可以执行以下任何行动。输入8以完成并继续：

**我可以执行的高级反思、需求获取与头脑风暴行动：**

1. **关键安全评估与风险分析**
2. **平台集成与组件兼容性评估**
3. **跨环境一致性审查**
4. **技术债务与可维护性分析**
5. **合规与监管对齐深度分析**
6. **成本优化与资源效率分析**
7. **运营韧性与理论推演**
8. **完成此部分并继续。**

在我执行选定的行动后，我们可以讨论结果，并决定是否对本部分进行进一步修订。”

重复：询问用户是否希望执行另一个反思、需求获取和头脑风暴行动，或选择 #8
